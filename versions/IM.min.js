(function(q){var r=false,e=null,i=100,d=false,b=0,s=[],p=t,u=window.parseFloat;function c(y){var C=4,w=y.toString(),E=[".",","],x,B,z,G,F,v,D;for(var A=0;A<E.length;A++){D=w.indexOf(E[A]);if(D!=-1){F=E[A];break}}v=(w.length-1)-D;if(typeof C!="undefined"){v=C}B=D+(v+1);if(D!=-1){x=w.substr(B,1);w=w.substr(0,B);if(x>=5){z=w.substr(w.length-1,1);if(z==F){w=(w.substr(0,w.length-1)*1)+1}else{w=w.substr(0,w.length-1)+((z*1)+1)}}}G=u(w);return G}function l(w,y,A){var z=w.concat();var v=w.length-1;var B=+new Date();setTimeout(function x(){do{v--;if(y(z.shift(),v)===false){return}}while(z.length>0&&(+new Date()-B<50));if(z.length>0){setTimeout(x,25)}else{A(w)}},25)}function t(w,x,z){var y=w.concat();var v=w.length;var A=null;while(Boolean(A=y.shift())){v--;if(x(A,v)===false){return}}z(w)}function o(v,y,w,B){var C=null,x=null,E=undefined,z=undefined,D=null,A=null;if(r&&typeof B==="undefined"){B=+new Date()}p(v,function(J,F){var I=J.getContext("2d"),H=I.getImageData(0,0,J.width,J.height),G=JSON.stringify([].slice.call(H.data));if(C!==null){if(C.localeCompare(G)!==0){D=k(J.width,J.height,H,x);z=D.percentage;A=D.canvas;if(z>=i){return true}if(e){e.appendChild(A)}J.className="fail";if(r){E=(+new Date()-B)}w(J,E,z);return false}}x=H;C=G},function(F){if(r){E=(+new Date()-B)}y(F,E,z)})}function k(C,S,H,L){var x=H.data,M=L.data,D=0,P=0,O=0,E=document.createElement("canvas"),J=E.getContext("2d"),N=J.createImageData(C,S),K=N.data,y=0,V=0,F=0,I=0,G=0,R=K.length,U,B,z,T,A,v,w,Q;E.width=C;E.height=S;E.style.border="#000 1px solid";for(y=R-1;y>0;y=y-4){K[y]=255}D=H.height*H.width;for(V=H.height;V--;){for(F=H.width;F--;){I=4*(V*C+F);G=4*(V*H.width+F);U=x[G+0];B=x[G+1];z=x[G+2];T=x[G+3];A=M[G+0];v=M[G+1];w=M[G+2];Q=M[G+3];if(U===A&&B===v&&z===w&&T===Q){K[I+0]=Math.abs(U-A);K[I+1]=Math.abs(B-v);K[I+2]=Math.abs(z-w);K[I+3]=Math.abs(T-Q)}else{P++;K[I+0]=x[G+0];K[I+1]=x[G+1];K[I+2]=x[G+2];K[I+3]=x[G+3]}}}J.putImageData(N,0,0);O=Math.abs((((P-D)/D)*100));return{percentage:c(O),canvas:E}}function n(x,A,w,z){s=[];if(r){var y=+new Date()}p(A,function(C,B){var F,E,D;F=document.createElement("canvas");F.id="canvasCompare_"+B;s.push(F);F.width=C.width;F.height=C.height;x.appendChild(F);E=F.getContext("2d");D=new Image();D.onload=function(){b++;E.drawImage(D,0,0)};D.onerror=function(){b++};D.src=C.src},function v(B){if(b<B.length){setTimeout(function(){v(B)},25)}else{o(s,w,z,y)}})}var g=function(x,w,v){this.src=x+(x.indexOf("?")===-1?"?":"&")+(+new Date());this.width=w;this.height=v};function f(){}f.prototype.setDebug=function a(v){r=v;return r};f.prototype.setAsynchronous=function m(v){d=v;p=d?l:t;return v};f.prototype.showDiffInCanvas=function j(v){e=v;return e};f.prototype.setTolerance=function h(v){i=v;return i};f.prototype.compare=function(w,y,v,x){if(!w.nodeType){o.apply(this,arguments)}else{n.apply(this,arguments)}};f.prototype.image=g;q.IM=new f()}(window));