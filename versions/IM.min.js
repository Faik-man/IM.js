(function(p){var r=false,e=null,i=100,d=false,b=0,s=[],o=t,u=window.parseFloat;function c(y){var C=4,w=y.toString(),E=[".",","],x,B,z,G,F,v,D;for(var A=0;A<E.length;A++){D=w.indexOf(E[A]);if(D!=-1){F=E[A];break}}v=(w.length-1)-D;if(typeof C!="undefined"){v=C}B=D+(v+1);if(D!=-1){x=w.substr(B,1);w=w.substr(0,B);if(x>=5){z=w.substr(w.length-1,1);if(z==F){w=(w.substr(0,w.length-1)*1)+1}else{w=w.substr(0,w.length-1)+((z*1)+1)}}}G=u(w);return G}function k(w,y,A){var z=w.concat();var v=w.length-1;var B=+new Date();setTimeout(function x(){do{v--;if(y(z.shift(),v)===false){return}}while(z.length>0&&(+new Date()-B<50));if(z.length>0){setTimeout(x,25)}else{A(w)}},25)}function t(w,x,z){var y=w.concat();var v=w.length-1;var A=null;while(Boolean(A=y.shift())){v--;if(x(A,v)===false){return}}z(w)}function n(w,y,C,A){var z=null,x=null,B=undefined,v=undefined;if(r&&typeof A==="undefined"){A=+new Date()}o(w,function(H,D){var G=H.getContext("2d"),F=G.getImageData(0,0,H.width,H.height),E=JSON.stringify([].slice.call(F.data));if(z!==null){if(z.localeCompare(E)!==0){if(r){H.className="fail";B=(+new Date()-A)}if(e){v=j(e,H.width,H.height,F,x);if(v>=i){y(w,B,v);return false}}C(H,B,v);return false}}x=F;z=E},function(D){if(r){B=(+new Date()-A)}y(D,B)})}function j(v,D,T,I,M){var y=I.data,N=M.data,E=0,Q=0,P=0,F=document.createElement("canvas"),K=F.getContext("2d"),O=K.createImageData(D,T),L=O.data,z=0,W=0,G=0,J=0,H=0,S=L.length,V,C,A,U,B,w,x,R;F.width=D;F.height=T;F.style.border="#000 1px solid";v.appendChild(F);for(z=S-1;z>0;z=z-4){L[z]=255}E=I.height*I.width;for(W=I.height;W--;){for(G=I.width;G--;){J=4*(W*D+G);H=4*(W*I.width+G);V=y[H+0];C=y[H+1];A=y[H+2];U=y[H+3];B=N[H+0];w=N[H+1];x=N[H+2];R=N[H+3];if(V===B&&C===w&&A===x&&U===R){L[J+0]=Math.abs(y[H+0]-N[H+0]);L[J+1]=Math.abs(y[H+1]-N[H+1]);L[J+2]=Math.abs(y[H+2]-N[H+2]);L[J+3]=Math.abs(y[H+3]-N[H+3])}else{Q++;L[J+0]=y[H+0];L[J+1]=y[H+1];L[J+2]=y[H+2];L[J+3]=y[H+3]}}}K.putImageData(O,0,0);P=Math.abs((((Q-E)/E)*100));return c(P)}function m(x,A,w,z){s=[];if(r){var y=+new Date()}o(A,function(C,B){var F,E,D;F=document.createElement("canvas");F.id="canvasCompare_"+B;s.push(F);F.width=C.width;F.height=C.height;x.appendChild(F);E=F.getContext("2d");D=new Image();D.onload=function(){b++;E.drawImage(D,0,0)};D.onerror=function(){b++};D.src=C.src},function v(B){if(b<B.length){setTimeout(function(){v(B)},25)}else{n(s,w,z,y)}})}var g=function(x,w,v){this.src=x+(x.indexOf("?")===-1?"?":"&")+(+new Date());this.width=w;this.height=v};function f(){}f.prototype.setDebug=function a(v){r=v;return r};f.prototype.setAsynchronous=function l(v){d=v;o=d?k:t;return v};f.prototype.setDiff=function q(v){e=v;return e};f.prototype.setPercentageDiff=function h(v){i=v;return i};f.prototype.compare=function(w,y,v,x){if(!w.nodeType){n.apply(this,arguments)}else{m.apply(this,arguments)}};f.prototype.image=g;p.IM=new f()}(window));