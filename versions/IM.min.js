(function(c){var p=false,q=null,o=false,b=0,a=[],h=i;function l(s,u,w){var v=s.concat();var r=s.length-1;var x=+new Date();setTimeout(function t(){do{r--;if(u(v.shift(),r)===false){return}}while(v.length>0&&(+new Date()-x<50));if(v.length>0){setTimeout(t,25)}else{w(s)}},25)}function i(s,t,v){var u=s.concat();var r=s.length-1;var w=null;while(Boolean(w=u.shift())){r--;if(t(w,r)===false){return}}v(s)}function d(r,t,x,v){var u=null,s=null,w=undefined;if(p&&typeof v==="undefined"){v=+new Date()}h(r,function(C,y){var B=C.getContext("2d"),A=B.getImageData(0,0,C.width,C.height),z=JSON.stringify([].slice.call(A.data));if(u!==null){if(u.localeCompare(z)!==0){if(q){n(q,C.width,C.height,A,s)}if(p){C.className="fail";w=(+new Date()-v);console.log("Fail -> Time: "+w);console.log("Failing  canvas is: ");console.log(document.getElementById("canvasCompare_"+y))}x(C,w);return false}}s=A;u=z},function(y){if(p){w=(+new Date()-v);console.log("Success -> Time: "+w)}t(y,w)})}function n(G,y,z,x,B){var v=x.data,E=B.data,w=document.createElement("canvas"),D=w.getContext("2d"),u=D.createImageData(y,z),H=u.data,s=0,t=0,r=0,F=0,C=0,A=H.length;w.width=y;w.height=z;G.appendChild(w);for(s=A-1;s>0;s=s-4){H[s]=255}for(t=x.height;t--;){for(r=x.width;r--;){F=4*(t*y+r);C=4*(t*x.width+r);H[F+0]=Math.abs(v[C+0]-E[C+0]);H[F+1]=Math.abs(v[C+1]-E[C+1]);H[F+2]=Math.abs(v[C+2]-E[C+2])}}D.putImageData(u,0,0)}function j(t,w,s,v){a=[];if(p){var u=+new Date()}h(w,function(y,x){var B,A,z;B=document.createElement("canvas");B.id="canvasCompare_"+x;a.push(B);B.width=y.width;B.height=y.height;t.appendChild(B);A=B.getContext("2d");z=new Image();z.onload=function(){b++;A.drawImage(z,0,0)};z.onerror=function(){b++};z.src=y.src},function r(x){if(b<x.length){setTimeout(function(){r(x)},25)}else{d(a,s,v,u);if(p&&o){console.log("After compare -> Time: "+(+new Date()-u))}}})}var g=function(t,s,r){this.src=t+(t.indexOf("?")===-1?"?":"&")+(+new Date());this.width=s;this.height=r};function e(){}e.prototype.setDebug=function k(r){p=r;return p};e.prototype.setAsynchronous=function m(r){o=r;h=o?l:i;return r};e.prototype.setDiff=function f(r){q=r;return q};e.prototype.compare=function(s,u,r,t){if(!s.nodeType){d.apply(this,arguments)}else{j.apply(this,arguments)}};e.prototype.image=g;c.IM=new e()}(window));